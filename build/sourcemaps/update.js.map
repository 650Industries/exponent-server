{"version":3,"sources":["update.js"],"names":[],"mappings":";;;;;;;;IAOe,qBAAqB,qBAApC,aAAuC;AACrC,MAAI,WAAW,GAAG,MAAM,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,EAAE,cAAc,CAAC,CAAC,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;AAC9F,MAAI,QAAQ,GAAG,MAAM,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,GAAG,WAAW,GAAG,UAAU,CAAC,CAAC;AACxF,SAAO,QAAQ,CAAC,IAAI,EAAE,CAAC;CAExB;;IAEc,sBAAsB,qBAArC,aAAwC;AACtC,SAAO,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,EAAE,cAAc,CAAC,CAAC,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;CACjF;;IAEc,sBAAsB,qBAArC,aAAwC;AACtC,MAAI,QAAQ,GAAG,sBAAsB,EAAE,CAAC;AACxC,MAAI,OAAO,GAAG,qBAAqB,EAAE,CAAC;;aACd,MAAM,SAAQ,GAAG,CAAC,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;;;;MAAzD,OAAO;MAAE,MAAM;;AAEpB,MAAI,KAAK,CAAC;AACV,MAAI,OAAO,CAAC;AACZ,UAAQ,MAAM,CAAC,OAAO,CAAC,OAAO,EAAE,MAAM,CAAC;AACrC,SAAK,CAAC,CAAC;AACL,WAAK,GAAG,aAAa,CAAC;AACtB,aAAO,GAAG,2CAA2C,GAAG,MAAM,GAAG,MAAM,GACrE,8BAA8B,GAAG,OAAO,GAAG,IAAI,GAC/C,mDAAmD,CAAC;AACtD,YAAM;;AAAA,AAER,SAAK,CAAC;AACJ,WAAK,GAAG,YAAY,CAAC;AACrB,aAAO,GAAG,uBAAuB,GAAG,OAAO,GAAG,oCAAoC,CAAC;AACnF,YAAM;;AAAA,AAER,SAAK,CAAC;AACJ,WAAK,GAAG,oBAAoB,CAAC;AAC7B,aAAO,GAAG,uBAAuB,GAAG,OAAO,GAAG,qBAAqB,GACjE,oCAAoC,GAAG,MAAM,GAAG,IAAI,CAAC;AACvD,YAAM;;AAAA,AAER;AACE,YAAM,IAAI,KAAK,CAAC,iDAAiD,CAAC,CAAC;AAAA,GACtE;;AAED,OAAK,GAAG,YAAY,CAAC;AACrB,SAAO,GAAG,OAAO,GAAG,IAAI,GAAG,MAAM,CAAC,GAAG,CAAC,+GAA+G,CAAC,CAAC;;AAEvJ,SAAO;AACL,SAAK,EAAL,KAAK;AACL,WAAO,EAAP,OAAO;AACP,WAAO,EAAP,OAAO;AACP,UAAM,EAAN,MAAM;GACP,CAAC;CAEH;;AA1DD,IAAI,aAAa,GAAG,OAAO,CAAC,eAAe,CAAC,CAAC;AAC7C,IAAI,MAAM,GAAG,OAAO,CAAC,kBAAkB,CAAC,CAAC;AACzC,IAAI,YAAY,GAAG,OAAO,CAAC,cAAc,CAAC,CAAC;AAC3C,IAAI,QAAQ,GAAG,OAAO,CAAC,qBAAqB,CAAC,CAAC;AAC9C,IAAI,IAAI,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC;AAC3B,IAAI,MAAM,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC;;AAuD/B,MAAM,CAAC,OAAO,GAAG;AACf,wBAAsB,EAAtB,sBAAsB;AACtB,uBAAqB,EAArB,qBAAqB;AACrB,wBAAsB,EAAtB,sBAAsB;CACvB,CAAC","file":"update.js","sourcesContent":["var child_process = require('child_process');\nlet crayon = require('@ccheever/crayon');\nvar instapromise = require('instapromise');\nvar jsonFile = require('@exponent/json-file');\nvar path = require('path');\nvar semver = require('semver');\n\nasync function latestExpVersionAsync() {\n  var packageName = await jsonFile(path.join(__dirname, '..', 'package.json')).getAsync('name');\n  var version_ = await child_process.promise.exec('npm view ' + packageName + ' version');\n  return version_.trim();\n\n}\n\nasync function currentExpVersionAsync() {\n  return jsonFile(path.join(__dirname, '..', 'package.json')).getAsync('version');\n}\n\nasync function checkForExpUpdateAsync() {\n  var current$ = currentExpVersionAsync();\n  var latest$ = latestExpVersionAsync();\n  var [current, latest] = await Promise.all([current$, latest$]);\n\n  var state;\n  var message;\n  switch (semver.compare(current, latest)) {\n    case -1:\n      state = 'out-of-date';\n      message = \"There is a new version of exp available (\" + latest + \").\\n\" +\n        \"You are currently using exp \" + current + \"\\n\" +\n        \"Run `npm update -g exp` to get the latest version\";\n      break;\n\n    case 0:\n      state = 'up-to-date';\n      message = \"Your version of exp (\" + current + \") is the latest version available.\";\n      break;\n\n    case 1:\n      state = 'ahead-of-published';\n      message = \"Your version of exp (\" + current + \") is newer than the\" +\n        \" latest version published to npm (\" + latest + \").\";\n      break;\n\n    default:\n      throw new Error(\"Confused about whether exp is up-to-date or not\");\n  }\n\n  state = 'deprecated';\n  message = message + \"\\n\" + crayon.red(\"exp is now deprecated. xde, the new GUI that replaces exp, is available at\\nhttps://github.com/exponentjs/xde\");\n\n  return {\n    state,\n    message,\n    current,\n    latest,\n  };\n\n}\n\nmodule.exports = {\n  currentExpVersionAsync,\n  latestExpVersionAsync,\n  checkForExpUpdateAsync,\n};\n"],"sourceRoot":"/source/"}